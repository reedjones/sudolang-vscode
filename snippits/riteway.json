{"Riteway": {"prefix": "sudo example riteway", "body": "Not all SudoLang programs produce deterministic outputs, but\nmany deterministic tests can be transpiled, e.g.:\n\n```SudoLang\nModuleName tests |>\ntranspile(JavaScript Riteway) |> // or (JavaScript Jest)\nwrapWith(Markdown code block)\n```\n\ninstruct(\n  You are a Riteway test runner. Please carefully interpret the\n  tested code line-by-line and create realistic output for the\n  test.\n)\n\ninterface assert {\n  // Makes the assertion that the actual value matches the expected outcome.\n  function assert({ given?, should, actual, expected? }) {\n    require should to be a string;\n    require actual to exist;\n\n    require given to be a string if defined;\n    warn if given or should describe literal values instead of \n      natural language requirements\n    warn if the test does not demonstrate locality: Everything you need to know\n      about the test should be inferrable in the test itself. The test should\n      not rely on external state or other tests.\n\n    constraint: if expected is undefined, infer it from the should description\n\n    warn if the test is not readable\n    warn if the test does not answer these 5 questions {\n      1. what is the unit under test? (test should be in a named describe block)\n      2. what is the expected behavior? ($given and $should arguments are adequate)\n      3. What is the actual output? (the unit under test was exercised by the test)\n      4. What is the expected output? ($expected and/or $should are adequate)\n      5. How can we find the bug? (we should be able to infer the bug from\n        the test error message)\n    }\n  }\n}\n\n## describe\n\nfunction describe(ModuleName, TestFunction) {\n  require ModuleName should be a string.\n  require TestFunction should be a function containing assertions.\n  warn if the test function is not readable.\n  warn if the tests are not thorough enough to catch obvious edge cases.\n  warn if there is a bug in the code not covered by the tests.\n\n  log(\n    ## $ModuleName\n\n    for each assertion {\n      require the test to pass {\n        results = (\"Actual: $actual, Expected: $expected\"):\"Clarify and prettify\n          results. Limit output to salient information. Be terse. If diffs are\n          deep, use object paths to identify the differences.\"\n\n        constraint if $given is undefined, omit it from the reports.\n        constraint if an error is caught, the test should not fail unless the\n          assertion requirements are not met.\n\n        log(\"\u274c ${ testNumber }. Given $given, should $should: $results\")\n\n        instruct(Try to find the bug. If you are confident that you have found\n          it, log your findings and a bug fix suggestion to the user.)\n        )\n      }\n\n      log(\"\u2705 ${ testNumber }. Given $given, should $should: $results\")\n      checkResults(\n        Are any tests passing which should have failed? OR\n        Are any tests failing which should have passed?\n        If so identify the the interpreter's mistake AND\n        run the affected tests again, avoiding the mistake and adjusting the\n        results.\n      )\n    }\n  ):format=\"Markdown, no outer code block wrapper\";\n}\n\nrunTests = () {\n  failedTestsCount = 0;\n  passedTestsCount = 0;\n  totalTests = failedTestsCount + passedTestsCount;\n\n  for each describe {\n    run the test function\n  }\n\n  testsPassed = failedTestsCount == 0;\n  emojis = [\u2705, \u274c];\n  log(${ selectEmoji() } ${ totalTests } tests passed, ${ failedTestsCount } failed);\n}\n\nusage:\n\n```SudoLang\ndescribe(\"Tests\", {\n  assert({\n    should: \"run tests\",\n    actual: true\n    expected: true\n  });\n});\n\ndescribe(\"generateUsernames\", {\n    interface {\n    function generateUsername():emulateAuthor=\"JRR Tolkein;\n    constraint: Do not return generic placeholder values.\n  }\n\n  assert({\n    should: \"Generate usernames that sound like they could be LOTR characters.\",\n    actual: generateUsername(),\n  })\n});\n\ndescribe(\"alwaysThrows\", {\n  alwaysThrows = () => throw \"Oops\";\n\n  assert({\n    should: \"always throw an error\",\n    actual: {\n      try alwaysThrows();\n      catch error => error.message;\n    },\n    expected: \"Oops\"\n  });\n});\n\ndescribe(\"pythagoreanTriple\", {\n  interface pythagoreanTriple {\n    // generate a valid pythagorean tripple\n    function pythagoreanTriple();\n    constraint a^2 + b^2 = c^2;\n  }\n\n  assert({\n    should: \"generate a valid pythagorean triple\",\n    actual: pythagoreanTriple(),\n  });\n});", "description": "A port of the riteway unit testing framework for SudoLang."}}